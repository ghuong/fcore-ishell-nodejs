const path = require("path");

const { testModes } = require("./config");
const fsHelper = require("./fsHelper");

const rewriteModulesIntoSandboxes = require("./rewriteModulesIntoSandboxes");
const { runPuretests } = require("./runPuretests");

function setup(dir, rewriteDir) {
  fsHelper.removeDir(rewriteDir); // nuke rewrites directory
  const files = fsHelper.listFiles(dir);
  const filepaths = files.map((f) => path.join(dir, f));
  return { files, filepaths };
}

function teardown(rewriteDir) {
  fsHelper.removeDir(rewriteDir);
}

module.exports = {
  setup,
  teardown,
  runPuretests,
  rewriteModulesIntoSandboxes,
  testModes,
}